[meta]
description:
    Vakken per student met verzoek of inschrijving voor collegejaar [collegejaar]
qtype: PRD

[query]
sql:
    select distinct
        s_vak.STUDENTNUMMER,
        s_vak.VOOROPLEIDING,
        s_vak.VAK,
        r_vak.NAAM,
        s_vak.CIJFER,
        s_vak.STATUS_VERIFICATIE
    from
        (OSIRIS.OST_STUDENT_VAK s_vak
        join OSIRIS.OST_VAK r_vak
        on s_vak.VAK = r_vak.VAK)
        join OSIRIS.OST_STUDENT_INSCHRIJFHIST s_sih
        on s_vak.STUDENTNUMMER = s_sih.STUDENTNUMMER
    where
        s_sih.COLLEGEJAAR = 2019
        and (
            s_sih.INSCHRIJVINGSTATUS = 'V'
            or s_sih.INSCHRIJVINGSTATUS = 'I'
            )
        and s_vak.STATUS_VERIFICATIE='UG'

[columns]
    STUDENTNUMMER
    VOOROPLEIDING: category
    VAK_CODE: category
    VAK_NAAM: category
    CIJFER
    STATUS_VERIFICATIE: category
