[meta]
description:
    Vooropleidingsregels per student met verzoek of inschrijving voor collegejaar [collegejaar]
qtype:
    PRD

[query]
sql:
    select distinct
        s_vopl.STUDENTNUMMER,
        s_vopl.VOOROPLEIDING,
        r_vopl.NAAM,
        r_vopl.TYPE_VOOROPLEIDING,
        s_vopl.SCHOOL_NAAM,
        s_vopl.SCHOOL_PLAATS,
        s_vopl.SCHOOL_LAND,
        s_vopl.EXTENSIE_LAND,
        s_vopl.STATUS_VERIFICATIE,
        s_vopl.DATUM_VERIFICATIE
    from
        OSIRIS.OST_VOOROPLEIDING r_vopl
        join (
            OSIRIS.OST_STUDENT_INSCHRIJFHIST s_sih
            join OSIRIS.OST_STUDENT_VOOROPLEIDING s_vopl
            on s_sih.STUDENTNUMMER = s_vopl.STUDENTNUMMER
            )
        on r_vopl.VOOROPLEIDING = s_vopl.VOOROPLEIDING
    where
        s_sih.COLLEGEJAAR = [collegejaar]
        and (
            s_sih.INSCHRIJVINGSTATUS = 'V'
            or s_sih.INSCHRIJVINGSTATUS = 'I'
            )

[columns]
    STUDENTNUMMER
    VOOROPLEIDING_CODE: category
    VOOROPLEIDING_NAAM: category
    VOOROPLEIDING_TYPE: category
    SCHOOL_NAAM
    SCHOOL_PLAATS
    SCHOOL_LAND
    EXTENSIE_LAND
    VERIFICATIE_STATUS: category
    VERIFICATIE_DATUM
