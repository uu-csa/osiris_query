[meta]
description:
    Vooropleidingsregels per eerstejaars bachelorstudent met verzoek of inschrijving voor collegejaar [collegejaar]
qtype:
    PRD

[query]
sql:
    select distinct
        s_vopl.STUDENTNUMMER,
        s_vopl.VOOROPLEIDING,
        r_vopl.NAAM,
        r_vopl.TYPE_VOOROPLEIDING,
        s_vopl.SCHOOL_NAAM,
        s_vopl.SCHOOL_PLAATS,
        s_vopl.SCHOOL_LAND,
        s_vopl.EXTENSIE_LAND,
        s_vopl.STATUS_VERIFICATIE,
        s_vopl.DATUM_VERIFICATIE
    from
        OSIRIS.OST_STUDENT_VOOROPLEIDING s_vopl
        join OSIRIS.OST_STUDENT_INSCHRIJFHIST s_sih
        on s_vopl.STUDENTNUMMER = s_sih.STUDENTNUMMER
            join OSIRIS.OST_STUDENT_OPLEIDING s_opl
            on s_vopl.STUDENTNUMMER = s_opl.STUDENTNUMMER
                join OSIRIS.OST_VOOROPLEIDING r_vopl
                on s_vopl.VOOROPLEIDING = r_vopl.VOOROPLEIDING
    where
        s_sih.COLLEGEJAAR = [collegejaar]
        and (
            s_sih.INSCHRIJVINGSTATUS = 'V'
            or s_sih.INSCHRIJVINGSTATUS = 'I'
            )
        and s_sih.EXAMENTYPE_CSA in (
            'BA',
            'PM'
            )

[columns]
    STUDENTNUMMER
    VOOROPLEIDING_CODE: category
    VOOROPLEIDING_NAAM: category
    VOOROPLEIDING_TYPE: category
    SCHOOL_NAAM
    SCHOOL_PLAATS
    SCHOOL_LAND
    EXTENSIE_LAND
    VERIFICATIE_STATUS: category
    VERIFICATIE_DATUM
